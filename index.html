<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-         title" content="365æŒ‘æˆ°">
<link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/628/628283.png">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>365å¤©æ”¯ä»˜æŒ‘æˆ°ï½œæ£®ç³»ç‰ˆ</title>
    <style>
        :root {
            --bg-forest: #f0f4ef;        /* æ¥µæ·ºç°ç¶ èƒŒæ™¯ */
            --card-white: #ffffff;
            --text-main: #3a473a;        /* æ·±æ£®æ—ç¶ æ–‡å­— */
            --accent-sage: #7c8c6d;      /* é¼ å°¾è‰ç¶  */
            --pay-deep: #4a5d4a;         /* æ·±æ©„æ¬–ç¶ ï¼ˆå½ˆçª—èƒŒæ™¯ï¼‰ */
            --btn-light-green: #c8d5bb;  /* æŠ¹èŒ¶ç‰›å¥¶è‰²ï¼ˆæŒ‰éˆ•ï¼‰ */
            --progress-bg: #e2e8df;      /* æ·ºç¶ é€²åº¦æ¢åº•è‰² */
            --completed-green: #8ba888;  /* å®Œæˆå¾Œçš„ç¶  */
        }

        body {
            font-family: "PingFang TC", "STHeitiTC-Light", sans-serif;
            background-color: var(--bg-forest);
            color: var(--text-main);
            margin: 0;
            padding: 20px 0;
            display: flex;
            justify-content: center;
            overflow-x: hidden;
        }

        .phone-container {
            max-width: 414px;
            width: 95%;
            background: var(--bg-forest);
            border-radius: 40px;
            padding: 40px 20px;
            min-height: 90vh;
            position: relative;
            box-shadow: 0 30px 60px rgba(58, 71, 58, 0.08);
            display: flex;
            flex-direction: column;
        }

        header { text-align: center; margin-bottom: 40px; position: relative; }
        .leaf-icon { color: var(--accent-sage); font-size: 1.5rem; position: absolute; top: 0; opacity: 0.7; }
        .leaf-left { left: 15px; transform: rotate(-15deg); }
        .leaf-right { right: 15px; transform: rotate(15deg); }
        
        h1 { font-size: 2.2rem; font-weight: 500; letter-spacing: 6px; margin: 0; line-height: 1.4; color: var(--text-main); }
        .subtitle { font-size: 0.85rem; color: var(--accent-sage); letter-spacing: 2px; margin-top: 15px; opacity: 0.8; }

        .progress-section {
            background: var(--card-white);
            border-radius: 35px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.03);
        }

        .rate-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .rate-badge { background: var(--bg-forest); padding: 8px 18px; border-radius: 20px; font-size: 0.9rem; font-weight: 600; color: var(--accent-sage); }
        .day-label { font-size: 0.85rem; color: var(--accent-sage); opacity: 0.8; }

        .bar-bg { height: 12px; background: var(--progress-bg); border-radius: 10px; overflow: hidden; }
        .bar-fill { height: 100%; background: var(--accent-sage); width: 0%; border-radius: 10px; transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1); }

        .grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            padding-bottom: 40px;
        }

        .box {
            background: var(--card-white);
            aspect-ratio: 0.85;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(0,0,0,0.02);
        }
        .box:active { transform: scale(0.95); }
        .box.completed { background-color: var(--completed-green); border: none; }
        .box-day { font-size: 0.65rem; color: var(--accent-sage); margin-bottom: 4px; font-weight: 600; }
        .box-amt { font-size: 1.15rem; font-weight: 600; color: var(--text-main); }
        .completed div { color: white !important; opacity: 1; }

        /* ä¸­å¤®å½ˆå‡ºå¼è¦–çª— - æ·±ç¶ æ£®æ—ç‰ˆ */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(42, 53, 42, 0.4);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .pay-modal {
            background: var(--pay-deep);
            border-radius: 45px;
            padding: 40px 30px;
            width: 82%;
            max-width: 320px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.4);
            text-align: center;
            color: #f0f4ef;
            animation: modalPop 0.4s cubic-bezier(0.2, 1, 0.3, 1.1);
        }

        @keyframes modalPop { 
            from { opacity: 0; transform: translateY(30px) scale(0.9); } 
            to { opacity: 1; transform: translateY(0) scale(1); } 
        }

        .pay-amt-title { font-size: 0.75rem; opacity: 0.6; margin-bottom: 8px; letter-spacing: 2px; text-transform: uppercase; }
        .pay-amt-val { font-size: 3.2rem; font-weight: 200; margin-bottom: 25px; color: #ffffff; }
        
        .wallet-info { 
            background: rgba(255,255,255,0.08);
            padding: 18px;
            border-radius: 28px;
            margin-bottom: 35px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .wallet-val { font-size: 1.1rem; font-weight: 300; letter-spacing: 1px; }

        .btn-confirm {
            background: var(--btn-light-green);
            color: var(--pay-deep);
            width: 100%;
            height: 70px;
            border-radius: 28px;
            border: none;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .btn-close {
            background: transparent;
            color: #ffffff;
            opacity: 0.5;
            border: none;
            margin-top: 25px;
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: underline;
            text-underline-offset: 4px;
        }

        /* æ–‡é’æ„Ÿè‘‰å­åœ–æ¨™ SVG */
        .icon-art { width: 24px; height: 24px; fill: var(--pay-deep); }

        footer {
            margin-top: auto;
            text-align: center;
            padding: 30px 0;
            font-size: 0.7rem;
            color: var(--accent-sage);
            letter-spacing: 3px;
            opacity: 0.6;
        }
    </style>
</head>
<body>

<div class="phone-container">
    <header>
        <div class="leaf-icon leaf-left">ğŸŒ¿</div>
        <div class="leaf-icon leaf-right">ğŸŒ¿</div>
        <h1>æ­² æœˆ æˆ é‡‘</h1>
        <div class="subtitle">æ¯ä¸€æ­¥ç©ç´¯ï¼Œéƒ½æ˜¯é€šå¾€è‡ªç”±çš„æ£®æ—</div>
    </header>

    <div class="progress-section">
        <div class="rate-info">
            <div class="rate-badge">é”æˆç‡ <span id="rate">0.0</span>%</div>
            <div class="day-label">å·²å®Œæˆ <span id="days">0</span> / 365</div>
        </div>
        <div class="bar-bg"><div class="bar-fill" id="fill"></div></div>
    </div>

    <div id="grid" class="grid"></div>

    <footer>â€” åœ¨æ™‚å…‰çš„æ—é–“ï¼Œç¨®ä¸‹å¸Œæœ›çš„ç¨®å­ â€”</footer>
</div>

<div class="modal-overlay" id="modalOverlay">
    <div class="pay-modal">
        <div class="pay-amt-title">æœ¬æ¬¡çŒæº‰é‡‘é¡</div>
        <div class="pay-amt-val">$<span id="modalAmt">0</span></div>
        
        <div class="wallet-info">
            <div class="pay-amt-title" style="margin-bottom: 5px; opacity: 0.5;">æ”¯ä»˜å¾Œå‰©é¤˜</div>
            <div class="wallet-val">$ <span id="walletAmt">66,795</span></div>
        </div>
        
        <button class="btn-confirm" onclick="confirmPay()">
            <svg class="icon-art" viewBox="0 0 24 24">
                <path d="M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,8 17,8 17,8Z" />
            </svg>
            ç¢ºèªæ”¯ä»˜
        </button>
        <button class="btn-close" onclick="closeModal()">æˆ‘å†æƒ³æƒ³</button>
    </div>
</div>

<script>
    let completed = JSON.parse(localStorage.getItem('365pay_forest_v1')) || [];
    let wallet = JSON.parse(localStorage.getItem('365pay_forest_wallet'));
    if (wallet === null) wallet = 66795; 

    function init() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        for (let i = 1; i <= 365; i++) {
            const div = document.createElement('div');
            div.className = 'box' + (completed.includes(i) ? ' completed' : '');
            div.innerHTML = `<div class="box-day">D${i}</div><div class="box-amt">${i}</div>`;
            div.onclick = () => openModal(i);
            grid.appendChild(div);
        }
        updateUI();
    }

    function openModal(i) {
        if(completed.includes(i)){
            if(confirm("è¦å–æ¶ˆé€™ä¸€å¤©çš„æ”¯ä»˜ä¸¦é€€å›é¤˜é¡å—ï¼Ÿ")) {
                completed = completed.filter(a => a !== i);
                wallet += i;
                init();
            }
            return;
        }
        document.getElementById('modalAmt').innerText = i;
        document.getElementById('walletAmt').innerText = (wallet - i).toLocaleString();
        window.pendingAmt = i;
        document.getElementById('modalOverlay').style.display = 'flex';
    }

    function closeModal() { document.getElementById('modalOverlay').style.display = 'none'; }

    function confirmPay() {
        if (wallet >= window.pendingAmt) {
            wallet -= window.pendingAmt;
            completed.push(window.pendingAmt);
            closeModal();
            init();
        } else {
            alert("é¤˜é¡ä¸è¶³ï¼Œè«‹å…ˆå„²å€¼ã€‚");
        }
    }

    function updateUI() {
        document.getElementById('days').innerText = completed.length;
        let currentTotal = completed.reduce((a, b) => a + b, 0);
        let rate = ((currentTotal / 66795) * 100).toFixed(1);
        document.getElementById('rate').innerText = rate;
        document.getElementById('fill').style.width = Math.min(rate, 100) + '%';
        localStorage.setItem('365pay_forest_v1', JSON.stringify(completed));
        localStorage.setItem('365pay_forest_wallet', JSON.stringify(wallet));
    }
    init();
</script>
</body>
</html>
